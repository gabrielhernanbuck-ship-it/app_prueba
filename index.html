<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ARGEN-PAY — Prototipo Móvil</title>

  <!-- Bootstrap & FontAwesome -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">

  <!-- Custom styles -->
  <link rel="stylesheet" href="styles.css" />
</head>
<body class="bg-light">

  <!-- Phone viewport wrapper to simulate mobile device width -->
  <div class="phone mx-auto shadow-sm bg-white">
    <!-- Header common (logo area) -->
    <header class="py-3 text-center">
      <div class="brand">ARGEN-PAY</div>
      <div class="powered">Powered By BANCO X</div>
    </header>

    <!-- ---------- PANTALLA: HOME / INICIO (Pantalla A) ---------- -->
    <main id="screen-home" class="screen p-3 active">
      <div class="d-grid gap-3">
        <!-- LOG IN en pantalla A: deberá comprobar si el usuario ya hizo clic en SIGN IN -->
        <button id="btn-home-login" class="btn btn-primary btn-lg">LOG IN</button>

        <!-- SIGN IN: abre pantalla de idioma (Pantalla B) y marca que se inició sign in -->
        <button id="btn-signin-home" class="btn btn-light btn-lg border" data-nav="screen-language">SIGN IN</button>

        <!-- CASH IN/OUT ahora tiene id para aplicar la misma validación -->
        <button id="btn-home-cash" class="btn btn-light btn-lg border" data-nav="screen-cash">CASH IN/OUT</button>
      </div>
      <div class="version">Versión 1.0</div>
    </main>

    <!-- ---------- SING IN Flow (Imagen 1) ---------- -->
    <!-- Screen B: language selection -->
    <section id="screen-language" class="screen p-3">
      <h5 class="text-center mt-2">Elija un idioma para continuar...</h5>
      <div class="d-grid gap-3 mt-3">
        <!-- Disabled-style languages open modal "idioma no disponible" -->
        <button class="btn btn-secondary btn-lg disabled-lang" data-bs-toggle="modal" data-bs-target="#modal-lang-unavailable">INGLÉS</button>

        <!-- Español: activo y permite avanzar -->
        <button class="btn btn-secondary btn-lg btn-esp" data-nav="screen-signup-form">ESPAÑOL</button>

        <button class="btn btn-secondary btn-lg disabled-lang" data-bs-toggle="modal" data-bs-target="#modal-lang-unavailable">PORTUGUES</button>
        <button class="btn btn-secondary btn-lg disabled-lang" data-bs-toggle="modal" data-bs-target="#modal-lang-unavailable">FRANCES</button>
      </div>
      <div class="mt-3 d-flex justify-content-between">
        <button class="btn btn-outline-secondary" data-nav="screen-home">&lt; VOLVER</button>
        <div class="version">Versión 1.0</div>
      </div>
    </section>

    <!-- Modal: idioma no disponible -->
    <div class="modal fade" id="modal-lang-unavailable" tabindex="-1" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content p-3">
          <div class="d-flex justify-content-between align-items-center">
            <h6 class="m-0">Idioma</h6>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <hr/>
          <p>Este idioma aun no está disponible.</p>
          <div class="text-end">
            <button class="btn btn-primary" data-bs-dismiss="modal">Cerrar</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Screen C: Signup form (datos personales) -->
    <section id="screen-signup-form" class="screen p-3">
      <h5 class="text-center">Bienvenido a ARGENPAY!</h5>
      <form id="signup-form" class="mt-3" autocomplete="off">
        <div class="mb-2">
          <input required type="text" class="form-control" placeholder="Nombre Completo">
        </div>
        <div class="mb-2">
          <input required type="text" class="form-control" placeholder="Apellido">
        </div>
        <div class="mb-2">
          <input required type="email" class="form-control" placeholder="Ingresar correo electrónico">
        </div>
        <div class="mb-2">
          <input required type="tel" class="form-control" placeholder="Ingresar teléfono">
        </div>
        <div class="mb-2">
          <input required type="password" class="form-control" placeholder="Ingresar contraseña">
        </div>
        <div class="mb-2">
          <input required type="password" class="form-control" placeholder="Repetir la contraseña">
        </div>

        <div class="d-grid gap-2 mt-2">
          <!-- Escanear Pasaporte/ID -> modal que indica cámara habilitada -->
          <button type="button" class="btn btn-outline-primary" data-bs-toggle="modal" data-bs-target="#modal-camera-scan">
            <i class="fa-solid fa-id-card-clip"></i> Escanear Pasaporte o ID
          </button>

          <!-- Tomar una Selfie -> ABRE UN MODAL (no navega) -->
          <button type="button" class="btn btn-outline-primary" data-bs-toggle="modal" data-bs-target="#modal-selfie">
            <i class="fa-solid fa-camera"></i> Tomar una Selfie
          </button>
        </div>

        <div class="mt-3 d-flex justify-content-between">
          <button type="button" class="btn btn-secondary" data-nav="screen-language">&lt; VOLVER</button>
          <!-- Al enviar el formulario, AVANZAMOS a la pantalla D (no validamos terminos aquí) -->
          <button type="submit" class="btn btn-primary">CONTINUAR</button>
        </div>
      </form>

      <div class="version">Versión 1.0</div>
    </section>

    <!-- Modal: camera scanning (from signup) -->
    <div class="modal fade" id="modal-camera-scan" tabindex="-1" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content p-3">
          <div class="d-flex justify-content-between align-items-center">
            <h6 class="m-0">Cámara</h6>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <hr/>
          <p>Cámara activada para escanear documento. (Simulación)</p>
          <div class="text-end">
            <button class="btn btn-primary" data-bs-dismiss="modal">Escanear y continuar</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal: selfie (DEBE SER MODAL, no navegación) -->
    <div class="modal fade" id="modal-selfie" tabindex="-1" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content p-3">
          <div class="d-flex justify-content-between align-items-center">
            <h6 class="m-0">Cámara - Selfie</h6>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <hr/>
          <p>Tomá una foto tipo selfie para validar identidad. (Simulación)</p>
          <div class="text-center mb-2">
            <div class="camera-placeholder border rounded p-4">[Vista de cámara simulada]</div>
          </div>
          <div class="d-flex justify-content-end gap-2">
            <button class="btn btn-outline-secondary" data-bs-dismiss="modal">Cancelar</button>
            <button class="btn btn-primary" data-bs-dismiss="modal">Usar selfie</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Screen D: currency and dates, terms (AHORA CON RADIOS) -->
    <section id="screen-signup-selfie" class="screen p-3">
      <h5 class="text-center">Elija la moneda con la que operará:</h5>

      <!-- Radios para seleccionar una opción (solo uno) -->
      <form id="currency-form" class="mt-3">
        <div class="form-check currency-option">
          <input class="form-check-input" type="radio" name="currency" id="currency-usd" value="USD">
          <label class="form-check-label" for="currency-usd">USDOLAR</label>
        </div>
        <div class="form-check currency-option">
          <input class="form-check-input" type="radio" name="currency" id="currency-eur" value="EUR">
          <label class="form-check-label" for="currency-eur">EURO</label>
        </div>

        <div class="mt-3">
          <label>Ingrese fecha de ingreso y salida:</label>
          <div class="d-flex gap-2">
            <input required type="date" class="form-control" id="date-in">
            <input required type="date" class="form-control" id="date-out">
          </div>
        </div>

        <div class="mt-3">
          <a href="#" id="leer-terminos" class="d-block">Leer Términos</a>
          <div class="form-check mt-1">
            <input class="form-check-input" type="checkbox" id="acepto">
            <label class="form-check-label" for="acepto">Entiendo y acepto.</label>
          </div>
        </div>

        <div class="mt-3 d-flex justify-content-between">
          <button class="btn btn-secondary" data-nav="screen-signup-form">&lt; VOLVER</button>
          <button type="button" class="btn btn-primary" id="signup-complete">CONTINUAR</button>
        </div>
      </form>

      <div class="version">Versión 1.0</div>
    </section>

    <!-- Screen E: signup success -->
    <section id="screen-signup-complete" class="screen p-3 text-center">
      <div class="success-icon my-4"><i class="fa-solid fa-circle-check fa-4x"></i></div>
      <h5>¡Felicitaciones, su información ha sido cargada exitosamente!</h5>
      <p>Le enviaremos una notificación cuando su perfil esté activo y su cuenta lista para recibir fondos.</p>
      <div class="mt-4 d-flex justify-content-center">
        <button class="btn btn-outline-secondary" data-nav="screen-home">Cerrar</button>
      </div>
      <div class="version">Versión 1.0</div>
    </section>

    <!-- ---------- LOG IN flow & Menu (Imagen 2) ---------- -->
    <!-- Modal: login form (se abre desde home LOG IN solamente si ya hizo click SIGN IN) -->
    <div class="modal fade" id="modal-login" tabindex="-1" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content p-3">
          <div class="d-flex justify-content-between align-items-center">
            <h6 class="m-0">LOG IN</h6>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <hr/>
          <div class="mb-2"><input class="form-control" placeholder="Documento"></div>
          <div class="mb-2"><input type="password" class="form-control" placeholder="Contraseña"></div>
          <div class="d-grid">
            <button id="btn-login-proceed" class="btn btn-primary">Ingresar</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal: login-warning (si intenta LOG IN sin haber dado SIGN IN en pantalla A) -->
    <div class="modal fade" id="modal-login-warning" tabindex="-1" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content p-3">
          <div class="d-flex justify-content-between align-items-center">
            <h6 class="m-0">Atención</h6>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <hr/>
          <p>Debes completar el registro antes de iniciar sesión.</p>
          <div class="text-end">
            <!-- Solo botón cerrar, como pediste -->
            <button class="btn btn-primary" data-bs-dismiss="modal">Cerrar</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal: cash-warning (si intenta CASH IN/OUT sin haber dado SIGN IN en pantalla A) -->
    <div class="modal fade" id="modal-cash-warning" tabindex="-1" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content p-3">
          <div class="d-flex justify-content-between align-items-center">
            <h6 class="m-0">Atención</h6>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <hr/>
          <p>Primero debes tener una cuenta creada para ingresar o retirar dinero de la aplicación.</p>
          <div class="text-end">
            <!-- Solo botón cerrar, según lo solicitado -->
            <button class="btn btn-primary" data-bs-dismiss="modal">Cerrar</button>
          </div>
        </div>
      </div>
    </div>

    <!-- After login -> main menu (screen-login) -->
    <section id="screen-login" class="screen p-3">
      <div class="d-flex justify-content-between align-items-center mb-2">
        <div class="profile">Perfil <i class="fa-regular fa-circle-user"></i></div>
        <button class="btn btn-sm btn-light" data-nav="screen-home">X</button>
      </div>

      <div class="balance text-center mb-3">
        <div class="small">Balance de Cuenta</div>
        <div class="h3 mb-0">USD 500.00</div>
        <div class="small text-muted">ARS 685,000.00</div>
      </div>

      <div class="d-grid gap-2">
        <button class="btn btn-outline-primary" data-nav="screen-map">MAPA DE PROMOCIONES</button>
        <button class="btn btn-outline-primary" data-nav="screen-history">HISTORIAL DE PAGOS</button>
        <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#modal-qr">QR SCANER</button>
      </div>

      <div class="version">Versión 1.0</div>
    </section>

    <!-- QR modal -->
    <div class="modal fade" id="modal-qr" tabindex="-1" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content p-3">
          <div class="d-flex justify-content-between">
            <h6 class="m-0">QR Scanner</h6>
            <button class="btn-close" data-bs-dismiss="modal"></button>
          </div>
          <hr/>
          <p>Cámara activada para escanear QR. (Simulación)</p>
          <div class="text-end">
            <button class="btn btn-primary" data-bs-dismiss="modal">Simular escaneo</button>
          </div>
        </div>
      </div>
    </div>

    <!-- History screen -->
    <section id="screen-history" class="screen p-3">
      <div class="d-flex justify-content-between align-items-center mb-2">
        <h6>Historial de Movimientos</h6>
        <button class="btn btn-sm btn-light" data-nav="screen-home">X</button>
      </div>

      <div class="history-box p-2 mb-3">
        <div class="history-entry">
          <div><small>17/08/2025 - Debit</small></div>
          <div class="fw-bold">ARS 200.00</div>
          <div>USD 22.67 <i class="fa-solid fa-question-circle text-muted"></i></div>
        </div>
        <div class="history-entry">
          <div><small>15/08/2025 - Debit</small></div>
          <div class="fw-bold">ARS 300.00</div>
          <div>USD 37.78 <i class="fa-solid fa-question-circle text-muted"></i></div>
        </div>
      </div>

      <div class="d-grid">
        <button class="btn btn-outline-secondary" data-nav="screen-login">RETURN TO MAIN MENU</button>
      </div>
    </section>

    <!-- Map screen -->
    <section id="screen-map" class="screen p-3">
      <div class="d-flex justify-content-between align-items-center mb-2">
        <h6>MAPA DE PROMOCIONES</h6>
        <button class="btn btn-sm btn-light" data-nav="screen-home">X</button>
      </div>

      <div class="map-wrapper mb-2">
        <svg viewBox="0 0 400 220" class="map-svg" role="img" aria-label="Mapa de la ciudad">
          <rect x="0" y="0" width="400" height="220" fill="#eef5ff"></rect>
          <path d="M0,120 Q100,60 200,120 T400,120" stroke="#cce0ff" stroke-width="28" fill="none" opacity="0.6"></path>

          <g class="pin" data-info="Tienda: 'El Ateneo' — 10% OFF" transform="translate(80,70)">
            <circle cx="0" cy="0" r="8" fill="#ff6b6b"></circle>
          </g>

          <g class="pin" data-info="Atracción: 'Jardín Japonés' — 15% OFF" transform="translate(250,40)">
            <circle cx="0" cy="0" r="8" fill="#f6b93b"></circle>
          </g>

          <g class="pin" data-info="Cultura: 'Teatro Colón' — 20% OFF" transform="translate(150,150)">
            <circle cx="0" cy="0" r="8" fill="#48dbfb"></circle>
          </g>

          <g class="pin" data-info="Café: 'Las Violetas' — 20% OFF" transform="translate(320,140)">
            <circle cx="0" cy="0" r="8" fill="#a29bfe"></circle>
          </g>
        </svg>
      </div>

      <div id="pin-info" class="card p-2 mb-2">
        <strong>Seleccioná un punto en el mapa</strong>
        <div id="pin-details" class="small text-muted mt-1">Aquí aparecerá la tarjeta con el descuento al tocar un pin.</div>
      </div>

      <div class="list-promos">
        <div class="promo-item">Tienda: "El Ateneo" — <span class="badge bg-primary">10% OFF</span></div>
        <div class="promo-item">Atracción: "Jardín Japonés" — <span class="badge bg-primary">15% OFF</span></div>
        <div class="promo-item">Cultura: "Teatro Colón" — <span class="badge bg-primary">20% OFF</span></div>
        <div class="promo-item">Café: "Las Violetas" — <span class="badge bg-primary">20% OFF</span></div>
      </div>

      <div class="version">Versión 1.0</div>
    </section>

    <!-- ---------- CASH IN/OUT Flow (Imagen 3) ---------- -->
    <section id="screen-cash" class="screen p-3">
      <div class="d-flex justify-content-between align-items-center mb-2">
        <h6>Cash In/Out</h6>
        <button class="btn btn-sm btn-light" data-nav="screen-home">X</button>
      </div>

      <div class="card p-2 mb-3">
        <div><strong>Datos Bancarios:</strong></div>
        <div class="bank-card mt-2 p-2">
          <div><strong>Beneficiary:</strong> Josh Smith</div>
          <div><strong>Account Number:</strong> XXXXXX</div>
          <div><strong>Country:</strong> Argentina</div>
          <div><strong>Bank Name:</strong> Banco X</div>
          <div><strong>SWIFT Code:</strong> BACOARBA</div>
          <div><strong>Sucursal N°:</strong> 999</div>
        </div>
      </div>

      <div class="mb-3">
        <div class="mb-2"><small>To deposit money:</small></div>
        <button class="btn btn-outline-primary mb-2" id="btn-share-details"><i class="fa-solid fa-share-nodes"></i> SHARE DETAILS</button>

        <div class="mt-3"><small>To rescue money:</small></div>
        <button class="btn btn-outline-danger mt-2" id="btn-rescue-order"><i class="fa-solid fa-hand-holding-dollar"></i> RESCUE ORDER</button>
      </div>

      <div class="version">Versión 1.0</div>
    </section>

    <!-- Modal: Share details -> simulate downloading PDF -->
    <div class="modal fade" id="modal-share-pdf" tabindex="-1" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content p-3">
          <div class="d-flex justify-content-between align-items-center">
            <h6 class="m-0">Compartir datos</h6>
            <button class="btn-close" data-bs-dismiss="modal"></button>
          </div>
          <hr/>
          <p>Descargando PDF con los datos para facilitarle a su banco y fondear su billetera.</p>
          <div class="text-end">
            <button class="btn btn-primary" id="btn-download-pdf">Descargar PDF</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal: Rescue order -->
    <div class="modal fade" id="modal-rescue" tabindex="-1" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content p-3">
          <div class="d-flex justify-content-between align-items-center">
            <h6 class="m-0">Rescue Order</h6>
            <button class="btn-close" data-bs-dismiss="modal"></button>
          </div>
          <hr/>
          <p>Sus fondos restantes serán transferidos nuevamente a su banco de origen. ¿Confirmar?</p>
          <div class="d-flex gap-2 justify-content-end">
            <button class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
            <button class="btn btn-danger" id="confirm-rescue">Confirmar rescate</button>
          </div>
        </div>
      </div>
    </div>

    <div class="modal fade" id="modal-rescue-done" tabindex="-1" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content p-3 text-center">
          <div class="m-3">
            <i class="fa-solid fa-check-circle fa-3x text-success"></i>
          </div>
          <h6>Operación realizada</h6>
          <p>Sus fondos serán transferidos a su banco de origen. Le notificaremos cuando se complete.</p>
          <div><button class="btn btn-outline-secondary" data-bs-dismiss="modal">Cerrar</button></div>
        </div>
      </div>
    </div>

    <!-- Generic terms modal -->
    <div class="modal fade" id="modal-terms" tabindex="-1" aria-hidden="true">
      <div class="modal-dialog modal-dialog-scrollable modal-lg">
        <div class="modal-content p-3">
          <div class="d-flex justify-content-between">
            <h6>Términos y condiciones</h6>
            <button class="btn-close" data-bs-dismiss="modal"></button>
          </div>
          <hr/>
          <p class="small">Aquí van los términos y condiciones (texto de ejemplo) — Al aceptar, confirma que ha leído y comprende los términos.</p>
          <div class="text-end">
            <button class="btn btn-primary" data-bs-dismiss="modal">Cerrar</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Footer spacing -->
    <div style="height:18px"></div>
  </div>

  <!-- Bootstrap scripts -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

  <!-- Inline script to handle nav and interactions (actualizado con lógica LOG IN / SIGN IN / CASH IN/OUT en pantalla A) -->
  <script>
    // Session flag in-memory (resets on reload)
    let signInInitiated = false;

    // Navigation between sections (screens)
    document.querySelectorAll('[data-nav]').forEach(btn => {
      btn.addEventListener('click', (e) => {
        const target = btn.getAttribute('data-nav');
        if (!target) return;
        // Hide all screens
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
        // Show target screen
        const el = document.getElementById(target);
        if (el) el.classList.add('active');
        // close any open modals
        document.querySelectorAll('.modal.show').forEach(m => bootstrap.Modal.getInstance(m)?.hide());
      });
    });

    // SIGN IN (home) -> open language screen and mark signInInitiated = true
    document.getElementById('btn-signin-home')?.addEventListener('click', (e) => {
      // mark as initiated for this session
      signInInitiated = true;
      // navigation handled by data-nav attribute (click already triggers it)
      const target = e.currentTarget.getAttribute('data-nav');
      if (target) {
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
        document.getElementById(target).classList.add('active');
      }
    });

    // LOG IN button on home: if signInInitiated -> open login modal, else show warning modal
    document.getElementById('btn-home-login')?.addEventListener('click', (e) => {
      if (signInInitiated) {
        // open login modal
        const m = new bootstrap.Modal(document.getElementById('modal-login'));
        m.show();
      } else {
        // open warning modal (solo en pantalla A)
        const warning = new bootstrap.Modal(document.getElementById('modal-login-warning'));
        warning.show();
      }
    });

    // CASH IN/OUT button on home: if signInInitiated -> navigate to screen-cash, else show cash-warning modal
    document.getElementById('btn-home-cash')?.addEventListener('click', (e) => {
      if (signInInitiated) {
        // open login modal
        const m = new bootstrap.Modal(document.getElementById('modal-login'));
        m.show();
      } else {
        // open warning modal (solo en pantalla A)
        const warning = new bootstrap.Modal(document.getElementById('modal-login-warning'));
        warning.show();
      }
    });

    // on login proceed: close modal and open screen-login
    document.getElementById('btn-login-proceed')?.addEventListener('click', () => {
      const modalEl = document.getElementById('modal-login');
      bootstrap.Modal.getInstance(modalEl)?.hide();
      document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
      document.getElementById('screen-login').classList.add('active');
    });

    // SIGNUP FORM submit: avanza a pantalla D
    document.getElementById('signup-form')?.addEventListener('submit', function(ev) {
      ev.preventDefault();
      // Go to currency/date screen (pantalla D)
      document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
      document.getElementById('screen-signup-selfie').classList.add('active');
    });

    // Signup continue button on screen-signup-selfie: valida que se haya elegido moneda y aceptado términos
    document.getElementById('signup-complete')?.addEventListener('click', () => {
      const acepto = document.getElementById('acepto')?.checked;
      const currencyChosen = !!document.querySelector('input[name="currency"]:checked');
      if (!currencyChosen) {
        alert('Por favor, seleccione la moneda (USD o EURO).');
        return;
      }
      if (!acepto) {
        const t = new bootstrap.Modal(document.getElementById('modal-terms'));
        t.show();
        return;
      }
      // proceed to success
      document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
      document.getElementById('screen-signup-complete').classList.add('active');
    });

    // terms link
    document.getElementById('leer-terminos')?.addEventListener('click', (e) => {
      e.preventDefault();
      const m = new bootstrap.Modal(document.getElementById('modal-terms'));
      m.show();
    });

    // Map pins: click event
    document.querySelectorAll('.map-svg .pin').forEach(pin => {
      pin.style.cursor = 'pointer';
      pin.addEventListener('click', () => {
        const info = pin.getAttribute('data-info');
        document.getElementById('pin-details').textContent = info;
      });
    });

    // CASH: share details button -> open modal that simulates PDF download
    document.getElementById('btn-share-details')?.addEventListener('click', () => {
      const m = new bootstrap.Modal(document.getElementById('modal-share-pdf'));
      m.show();
    });

    document.getElementById('btn-download-pdf')?.addEventListener('click', () => {
      const content = "ARGEN-PAY - Datos Bancarios\nBeneficiary: Josh Smith\nAccount Number: XXXXXX\nSWIFT: BACOARBA";
      const blob = new Blob([content], { type: 'application/pdf' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'ARGENPAY_Datos_Bancarios.pdf';
      document.body.appendChild(a);
      a.click();
      a.remove();
      URL.revokeObjectURL(url);
      bootstrap.Modal.getInstance(document.getElementById('modal-share-pdf')).hide();
      alert('PDF descargado (simulado). Compartilo con su banco para fondear su billetera.');
    });

    // Rescue order
    document.getElementById('btn-rescue-order')?.addEventListener('click', () => {
      const m = new bootstrap.Modal(document.getElementById('modal-rescue'));
      m.show();
    });
    document.getElementById('confirm-rescue')?.addEventListener('click', () => {
      bootstrap.Modal.getInstance(document.getElementById('modal-rescue')).hide();
      const done = new bootstrap.Modal(document.getElementById('modal-rescue-done'));
      done.show();
    });

    // Close buttons with X in top-right: return to initial screen
    document.querySelectorAll('.btn-sm.btn-light').forEach(xbtn => {
      xbtn.addEventListener('click', () => {
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
        document.getElementById('screen-home').classList.add('active');
      });
    });

    // Set initial active screen to home on load
    document.addEventListener('DOMContentLoaded', () => {
      document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
      document.getElementById('screen-home').classList.add('active');
      // ensure session flag starts false (resets on reload)
      signInInitiated = false;
    });
  </script>
</body>
</html>

